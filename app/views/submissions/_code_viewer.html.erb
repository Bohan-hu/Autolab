<div id="code-box">
  <div class="file-header">
    <div class="file-name">
      <i class="material-icons">insert_drive_file</i> <span><%= @displayFilename %></span>
    </div>

    <div class="file-button">
      <a href="#" onclick="copyFileToClipboard()">Copy Code</a>
    </div>
  </div>
  <% success = true %>
    <div class="code-table">
        <% @data.each_with_index do |(code, annotation), index| %>
          <div class="code-line" id="line-<%=index%>" data-line-id="<%=index%>">
            <div class="line-sticky">
              <div class="line-number"><%= index+1 %></div>
              <div class="code-separator"></div>
            </div>
            <div class="add-comment">
              <% if @cud.instructor? or @cud.course_assistant? then %><div class="add-button-container"><button class="add-button" id="add-btn-<%= index+1 %>"><i class="material-icons">add_comment</i></button></div><% end %>
            </div>
            <% begin %>
            <div class="code"><pre><code class="<%= @displayFilename.split(".")[-1].downcase %>"><%= code %></code></pre></div>
            <% rescue %>
              </code></pre></div></div>
              <% success = false %>
              <% break %>
            <% end %>
          </div>
          <div class="annotation-container" id="annotation-line-<%=index%>" data-line-id="<%=index%>">
          </div>
        <% end %>
    </div>
  <% if success == false %>
    <div id="code_error"> Unable to render file </div>
  <% end %>
</div>

<script>
  $(document).ready(function () {
    displayAnnotations();
    attachEvents();
  });
</script>
